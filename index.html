<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProjectorRays Web Decompiler</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>ProjectorRays Web Decompiler</h1>
        <p>Adobe Director / Shockwave Lingo Script Decompiler</p>
    </header>

    <main>
        <section id="upload-section">
            <div id="drop-zone">
                <p>Drag and drop a .cst, .cct, .dxr, or .dir file here</p>
                <p>or</p>
                <input type="file" id="file-input" accept=".cst,.cct,.dxr,.dir">
                <label for="file-input" class="file-button">Choose File</label>
            </div>
            <div id="file-info" class="hidden">
                <span id="file-name"></span>
                <button id="download-btn" class="hidden">Download Original</button>
                <button id="clear-btn">Clear</button>
            </div>
        </section>

        <section id="loading-section" class="hidden">
            <div class="spinner"></div>
            <p>Processing file...</p>
        </section>

        <section id="error-section" class="hidden">
            <h2>Error</h2>
            <pre id="error-message"></pre>
            <button id="error-dismiss">Dismiss</button>
        </section>

        <section id="content-section" class="hidden">
            <div id="left-panel">
                <div id="panel-tabs">
                    <button class="tab-btn active" data-tab="scripts">Scripts</button>
                    <button class="tab-btn" data-tab="assets">Assets</button>
                </div>
                <div id="scripts-tab" class="tab-content active">
                    <ul id="script-list"></ul>
                </div>
                <div id="assets-tab" class="tab-content">
                    <div id="asset-filters">
                        <input type="text" id="asset-search" placeholder="Search assets...">
                        <div id="type-filters">
                            <div id="type-filter-actions">
                                <button id="select-all-types" type="button">All</button>
                                <button id="select-none-types" type="button">None</button>
                            </div>
                            <label><input type="checkbox" value="Bitmap" checked> Bitmap</label>
                            <label><input type="checkbox" value="Sound" checked> Sound</label>
                            <label><input type="checkbox" value="Text" checked> Text</label>
                            <label><input type="checkbox" value="Palette" checked> Palette</label>
                            <label><input type="checkbox" value="Shape" checked> Shape</label>
                            <label><input type="checkbox" value="Button" checked> Button</label>
                            <label><input type="checkbox" value="Film Loop" checked> Film Loop</label>
                            <label><input type="checkbox" value="Picture" checked> Picture</label>
                            <label><input type="checkbox" value="Movie" checked> Movie</label>
                            <label><input type="checkbox" value="Digital Video" checked> Video</label>
                            <label><input type="checkbox" value="Rich Text" checked> Rich Text</label>
                        </div>
                        <div id="asset-count"></div>
                    </div>
                    <ul id="asset-list"></ul>
                </div>
            </div>
            <div id="right-panel">
                <div id="code-panel">
                    <div id="code-header">
                        <h2 id="current-script-name">Select a script</h2>
                        <div id="code-options">
                            <div id="code-view-tabs">
                                <button class="code-view-btn active" data-view="lingo">Lingo</button>
                                <button class="code-view-btn" data-view="lasm">LASM</button>
                            </div>
                            <label id="dot-syntax-label">
                                <input type="checkbox" id="dot-syntax" checked>
                                Dot Syntax
                            </label>
                            <button id="copy-btn" class="hidden">Copy</button>
                        </div>
                    </div>
                    <pre id="code-display"><code></code></pre>
                </div>
                <div id="asset-panel" class="hidden">
                    <div id="asset-header">
                        <h2 id="current-asset-name">Select an asset</h2>
                        <div id="asset-options">
                            <button id="download-asset-btn" class="hidden">Download</button>
                        </div>
                    </div>
                    <div id="asset-preview">
                        <div id="asset-info"></div>
                        <canvas id="asset-canvas" class="hidden"></canvas>
                        <div id="audio-player" class="hidden">
                            <audio id="sound-preview" controls></audio>
                        </div>
                        <pre id="asset-text" class="hidden"></pre>
                        <div id="asset-binary" class="hidden"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>ProjectorRays - <a href="https://github.com/ProjectorRays/ProjectorRays" target="_blank">GitHub</a></p>
        <p>Runs entirely in your browser - no server upload required</p>
    </footer>

    <!-- pako for zlib decompression -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>

    <script type="module" src="js/main.js"></script>
</body>
</html>
